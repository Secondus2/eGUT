<?xml version="1.0" encoding="UTF-8"?>
<document>
	<simulation name="demo" outputfolder="../Simulations" log="EXPRESSIVE">
		
		<timer stepSize="1.0" endOfSimulation="25.0" />
		
		<speciesLib>
			<species name="primary">
				<aspect name="reactions" type="LinkedList" >
					<item type="Reaction">
						<reaction name="growth">
							<expression value="mass * solute1 * k">
								<constant name="k" value="0.1" />
							</expression>
							<stochiometric component="primary" coefficient="1.0" />
							<stochiometric component="solute1" coefficient="-1.0" />
							<stochiometric component="solute2" coefficient="2.0" />
						</reaction>
					</item>
				</aspect>
				<speciesModule name="coccoid" />
			</species>
			<species name="secondary">
				<aspect name="reactions" type="LinkedList" >
					<item type="Reaction">
						<reaction name="growth">
							<expression value="mass * solute2"/>
							<stochiometric component="secondary" coefficient="1.0" />
							<stochiometric component="solute2" coefficient="-1.0" />
						</reaction>
					</item>
				</aspect>
				<speciesModule name="coccoid" />
			</species>
			<species name="coccoid">
				<aspect name="#isLocated" type="Boolean" value="true" />
				<aspect name="density" type="Double" value="1.0" />
				<aspect name="surfaces"			type="CALCULATED"	class="AgentSurfaces"			input="body"		package="agent.state.library."  />
				<aspect name="surface" 			type="CALCULATED" 	class="SimpleSurface" 			input="body" />
				<aspect name="coccoidCenter" 	type="CALCULATED" 	class="CoccoidCenter" 			input="body" />
				<aspect name="joints" 			type="CALCULATED" 	class="JointsState" 			input="body" />
				<aspect name="volume" 			type="CALCULATED" 	class="StateExpression" 		input="mass/density" />
				<aspect name="radius" 			type="CALCULATED" 	class="CoccoidRadius" 			input="volume" />
				<aspect name="growth" 			type="EVENT" 		class="SimpleGrowth"  	 		input="mass,growthRate" 	package="agent.event.library." />
				<aspect name="divide" 			type="EVENT" 		class="CoccoidDivision"			input="mass,radius,body" 	package="agent.event.library." />
				<aspect name="updateBody" 		type="EVENT" 		class="UpdateBody" 				input="body,radius,length" 	package="agent.event.library." />
			</species>
		</speciesLib>

		<compartment name="compartment">
			<shape class="Rectangle">
				<dimension name="X" isCyclic="true">
					<extreme name="max" position="16.0"/>
				</dimension> 
				<dimension name="Y" isCyclic="true">
					<extreme name="max" position="16.0"/>
				</dimension> 
			</shape>
			<solutes>
				<solute name="solute1" concentration="1.0" />
				<solute name="solute2" concentration="0.0" />
			</solutes>
			<reactions>
				<reaction name="slowInflow">
					<expression value="1.0 * inflow">
						<constant name="inflow" value="0.04" />
					</expression>
					<stochiometric component="solute1" coefficient="1.0" />
				</reaction>
			</reactions>
			<agents>
				<agent>
					<aspect name="species" type="String" value="primary" />
					<aspect name="mass" type="Double" value="0.2" />
					<aspect name="pigment" type="String" value="RED" />
					<aspect name="body" type="Body">
						<point position="12.2, 12.2" />
					</aspect>
				</agent>
				<agent>
					<aspect name="species" type="String" value="primary" />
					<aspect name="mass" type="Double" value="0.2" />
					<aspect name="pigment" type="String" value="RED" />
					<aspect name="body" type="Body">
						<point position="1.3, 8.2" />
					</aspect>
				</agent> 
				<agent>
					<aspect name="species" type="String" value="secondary" />
					<aspect name="mass" type="Double" value="0.2" />
					<aspect name="pigment" type="String" value="BLUE" />
					<aspect name="body" type="Body">
						<point position="12.0, 9.3" />
					</aspect>
				</agent>
			</agents>
			<processManagers>
				<process name="agentRelax" class="AgentRelaxation"  priority="1" firstStep="0.0" package="processManager." timerStepSize="0.5">
					<aspect name="maxMovement" type="Double" value="0.05" />
					<aspect name="relaxationMethod" type="String" value="EULER" />
				</process>
				<process name="solveDiffusionTransient" class="SolveDiffusionTransient"  priority="2" firstStep="0.0" package="processManager." timerStepSize="0.5">	
					<aspect name="solutes" type="String[]" value="solute1,solute2" />
					<aspect name="timerStepSize" type="Double" value="1.0" />
				</process>
				<process name="svgWriter" class="WriteAgentsSvg"  priority="0"
					firstStep="0.0" package="processManager.">
					<aspect name="prefix" type="String" value="out_solute1" />
					<aspect name="maxConcentration" type="Double" value="5.0" />
					<aspect name="solute" type="String" value="solute1" />
					<aspect name="timerStepSize" type="Double" value="1.0" />
				</process>
				<process name="svgWriter" class="WriteAgentsSvg"  priority="0"
					firstStep="0.0" package="processManager.">
					<aspect name="prefix" type="String" value="out_solute2" />
					<aspect name="maxConcentration" type="Double" value="2.0" />
					<aspect name="solute" type="String" value="solute2" />
					<aspect name="timerStepSize" type="Double" value="1.0" />
				</process>
			</processManagers>
		</compartment>
	</simulation>
</document>